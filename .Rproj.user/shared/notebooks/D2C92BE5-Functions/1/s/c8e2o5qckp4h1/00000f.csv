"0","filter_function <- function(data, subject_1 = ""Donor"", subject_1_behave, subject_2, subject_2_behave, modifier) {"
"0","  # Initialize an empty data frame for the result"
"0","  result <- data.frame()"
"0","  "
"0","  # Initialize a variable to track the last subject_1 interaction"
"0","  last_subject_1 <- -1"
"0","  "
"0","  # Initialize a variable to track the next subject_1 interaction"
"0","  next_subject_1 <- -1"
"0","  "
"0","  # Initialize a variable to track if subject_2's behavior was recorded since the last subject_1's behavior"
"0","  recorded_subject_2 <- FALSE"
"0","  "
"0","  # Find the next subject_1 interaction"
"0","  for (i in 1:nrow(data)) {"
"0","    current_row <- data[i,]"
"0","    if (current_row$Subject == subject_1 && current_row$Behavior == subject_1_behave && current_row$Modifier == modifier) {"
"0","      next_subject_1 <- i"
"0","      break"
"0","    }"
"0","  }"
"0","  "
"0","  # Iterate through each row in the data"
"0","  for (i in 1:nrow(data)) {"
"0","    current_row <- data[i,]"
"0","    indicator_value <- FALSE"
"0","    "
"0","    # If the current row is an observation of subject_1, add it to the result, update last_subject_1, and set the indicator value to TRUE"
"0","    if (current_row$Subject == subject_1 && current_row$Behavior == subject_1_behave && current_row$Modifier == modifier) {"
"0","      indicator_value <- TRUE"
"0","      last_subject_1 <- i"
"0","      "
"0","      # Update next_subject_1 to find the next subject_1 interaction"
"0","      next_subject_1 <- -1"
"0","      for (j in (i+1):nrow(data)) {"
"0","        next_row <- data[j,]"
"0","        if (complete.cases(next_row[, c(""Subject"", ""Behavior"", ""Modifier"")]) &&"
"0","            next_row$Subject == subject_1 &&"
"0","            next_row$Behavior == subject_1_behave && next_row$Modifier == modifier) {"
"0","          next_subject_1 <- j"
"0","          break"
"0","        }"
"0","      }"
"0","      "
"0","      recorded_subject_2 <- FALSE"
"0","    }"
"0","    "
"0","    # If the current row is an observation of subject_2 and it has the same modifier, it occurred after the last subject_1 interaction, and last_subject_1 has been updated from its initial value"
"0","    if (current_row$Subject == subject_2 && current_row$Behavior == subject_2_behave && current_row$Modifier == modifier && i > last_subject_1 && last_subject_1 != -1) {"
"0","      # If it is the first subject_2 after subject_1, set the indicator value to TRUE"
"0","      if (!recorded_subject_2) {"
"0","        indicator_value <- TRUE"
"0","        recorded_subject_2 <- TRUE"
"0","      } "
"0","      # If the start_time of subject_2 is smaller than the start_time of the next subject_1 and the end_time of subject_2 is greater than the start_time of the next subject_1, set the indicator value to TRUE"
"0","      else if (next_subject_1 != -1 && current_row$Start_Time < data[next_subject_1, ""Start_Time""] && current_row$End_Time > data[next_subject_1, ""Start_Time""]) {"
"0","        indicator_value <- TRUE"
"0","      }"
"0","      "
"0","      result <- rbind(result, cbind(current_row, indicator = indicator_value))"
"0","    } else if (indicator_value) {"
"0","      result <- rbind(result, cbind(current_row, indicator = indicator_value))"
"0","    }"
"0","  }"
"0","  return(result)"
"0","}"
"0",""
